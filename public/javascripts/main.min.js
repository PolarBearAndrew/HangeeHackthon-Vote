$(function(){var t={top:20,right:20,bottom:30,left:40},e=960-t.left-t.right,r=500-t.top-t.bottom,n=d3.format(".0%"),a=d3.scale.ordinal().rangeRoundBands([0,e],.1,1),c=d3.scale.linear().range([r,0]),o=d3.svg.axis().scale(a).orient("bottom"),l=d3.svg.axis().scale(c).orient("left").tickFormat(n),i=d3.select("body").append("svg").attr("width",e+t.left+t.right).attr("height",r+t.top+t.bottom).append("g").attr("transform","translate("+t.left+","+t.top+")");d3.tsv("data.tsv",function(t,e){function n(){clearTimeout(s);var t=a.domain(e.sort(this.checked?function(t,e){return e.frequency-t.frequency}:function(t,e){return d3.ascending(t.letter,e.letter)}).map(function(t){return t.letter})).copy();i.selectAll(".bar").sort(function(e,r){return t(e.letter)-t(r.letter)});var r=i.transition().duration(750),n=function(t,e){return 50*e};r.selectAll(".bar").delay(n).attr("x",function(e){return t(e.letter)}),r.select(".x.axis").call(o).selectAll("g").delay(n)}console.log(e,66),e.forEach(function(t){t.frequency=+t.frequency}),a.domain(e.map(function(t){return t.letter})),c.domain([0,d3.max(e,function(t){return t.frequency})]),i.append("g").attr("class","x axis").attr("transform","translate(0,"+r+")").call(o),i.append("g").attr("class","y axis").call(l).append("text").attr("transform","rotate(-90)").attr("y",6).attr("dy",".71em").style("text-anchor","end").text("Frequency"),i.selectAll(".bar").data(e).enter().append("rect").attr("class","bar").attr("x",function(t){return a(t.letter)}).attr("width",a.rangeBand()).attr("y",function(t){return c(t.frequency)}).attr("height",function(t){return r-c(t.frequency)}),d3.select("input").on("change",n);var s=setTimeout(function(){d3.select("input").property("checked",!0).each(n)},2e3)})});